{% extends 'base.html.twig' %}

{% block title %}{{ story.title }}{% endblock %}

{% block body %}

    <div class="container">
        {% for message in app.flashes('success') %}
            <div class="alert alert-success mt-4">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        {% endfor %}
        {% for message in app.flashes('warning') %}
            <div class="alert alert-warning mt-4">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        {% endfor %}
    </div>

    <section id="story-btn">
        <div class="btn-light-night btn-night">
            <i class="fa-solid fa-moon fa-2xl icon-night"></i>
        </div>

        <div class="btn-light-night btn-light btn-hidden">
            <i class="fa-solid fa-sun fa-2xl icon-light"></i>
        </div>

        <div class="btn-up btn-hidden">
            <i class="fa-solid fa-circle-chevron-up fa-2xl icon-up"></i>
        </div>
    </section>

    <section id="story-header">
        <div class="container">
            <div class="flex-container-reverse">
                <h1>{{ story.title }}</h1>
                {% if story.image %}
                    <img loading="lazy" class="story-img" src="/images/upload/{{ story.image }}" alt="illustration"/>
                {% else %}
                    <img loading="lazy" class="story-img" src="{{ asset('images/logojaune.png') }}" alt="illustration"/>
                {% endif %}
            </div>
            {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                <div class="favorite">
                    {% if story in favorite_stories %}
                        <a class="favorite-text" href="{{ path('app_story_favorite', {slug: story.slug}) }}">
                            <i class="fa-solid fa-heart"></i>
                            <span class="favorite-span"> Déjà en favoris</span>
                        </a>
                    {% else %}
                        <a class="favorite-text" href="{{ path('app_story_favorite', {slug: story.slug}) }}">
                            <i class="fa-regular fa-heart"></i>
                            <span class="favorite-span"> Mettre en favoris</span>
                        </a>
                    {% endif %}
                </div>
            {% endif %}
        </div>
    </section>

    <section id="story-text" class="light-bg">
        <div class="container">
            <div class="story-p">{{ story.text | raw }}</div>
            <div class="story-comments">
                <span class="comment-count">{{ story.comments|length }} commentaires</span>
                <hr>
                {% include "comment/index.html.twig" %}
            </div>
        </div>
    </section>

{% endblock %}

{% block javascripts %}
    {{ encore_entry_script_tags('story') }}
{% endblock %}
